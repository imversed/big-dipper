fullnameOverride: big-dipper
image:
  repository: us.gcr.io/spair-api/fulldivevr/big-dipper
  pullPolicy: Always
health:
  path: /health
  initialDelaySeconds: 60

service:
  http:
    port: 8080
    ingress:
      tls: true
      path: /
      annotations:
        kubernetes.io/ingress.class: nginx
        kubernetes.io/tls-acme: "true"
        nginx.ingress.kubernetes.io/ssl-redirect: "false"
        nginx.ingress.kubernetes.io/force-ssl-redirect: "false"
        nginx.ingress.kubernetes.io/limit-rps: "100"
        nginx.ingress.kubernetes.io/proxy-connect-timeout: "15s"
        nginx.ingress.kubernetes.io/affinity: cookie
        nginx.ingress.kubernetes.io/affinity-mode: persistent

antiAffinity: hard
podDisruptionBudget:
  minAvailable: 1
replicaCount: 1
resources:
  requests:
    cpu: 400m
    memory: 200Mi
  limits:
    cpu: 800m
    memory: 320Mi

env:
  - name: ROOT_URL
    value: http://localhost
  - name: PORT
    value: "8080"
  - name: METEOR_SETTINGS
    valueFrom:
      configMapKeyRef:
        key: settings
        name: meteor-config
  - name: MONGO_URL
    valueFrom:
      secretKeyRef:
        name: big-dipper-mongo-url
        key: url
